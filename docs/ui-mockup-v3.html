<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Context Lens ‚Äî UI Mockup v3</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; background: #0a0a0a; color: #e5e5e5; font-size: 13px; }
.app { display: grid; grid-template-columns: 280px 1fr; grid-template-rows: 48px 1fr; height: 100vh; }

/* Header */
.header { grid-column: 1 / -1; background: #141414; border-bottom: 1px solid #262626; display: flex; align-items: center; padding: 0 16px; gap: 12px; }
.header h1 { font-size: 15px; font-weight: 600; }
.header-right { margin-left: auto; display: flex; gap: 16px; align-items: center; font-size: 12px; }
.header select { background: #1e1e1e; border: 1px solid #333; color: #e5e5e5; padding: 4px 12px; border-radius: 4px; font-size: 12px; }

/* Sidebar */
.sidebar { background: #111; border-right: 1px solid #262626; overflow-y: auto; display: flex; flex-direction: column; }
.sidebar-search { width: calc(100% - 24px); margin: 8px 12px; background: #1a1a1a; border: 1px solid #262626; color: #e5e5e5; padding: 6px 10px; border-radius: 4px; font-size: 12px; }
.sidebar-section { padding: 10px 12px 4px; font-size: 10px; color: #555; text-transform: uppercase; letter-spacing: 0.08em; }
.session-item { padding: 8px 12px; cursor: pointer; border-left: 2px solid transparent; }
.session-item:hover { background: #1a1a1a; }
.session-item.active { background: #111827; border-left-color: #3b82f6; }
.session-head { display: flex; align-items: center; gap: 8px; }
.session-meta { display: flex; gap: 12px; margin-top: 4px; padding-left: 14px; font-size: 11px; color: #555; }
.badge { font-size: 9px; padding: 2px 6px; border-radius: 3px; font-weight: 700; text-transform: uppercase; }
.badge-claude { background: #451a03; color: #fb923c; }
.badge-codex { background: #052e16; color: #34d399; }
.dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
.dot-live { background: #3b82f6; box-shadow: 0 0 4px #3b82f6; }
.dot-done { background: #444; }
.turn-group { margin-left: 14px; border-left: 1px solid #1e1e1e; }
.tg-item { padding: 5px 12px; cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 12px; }
.tg-item:hover { background: #151515; }
.tg-item.active { background: #111827; }
.tg-num { color: #555; width: 16px; text-align: right; font-size: 11px; }
.tg-model { font-size: 9px; padding: 1px 4px; border-radius: 2px; }
.tg-opus { background: #1e1e1e; color: #fb923c; }
.tg-haiku { background: #1e1e1e; color: #a78bfa; }
.tg-tokens { margin-left: auto; color: #444; font-size: 11px; }
.sub-dots { display: flex; gap: 4px; padding: 2px 12px 2px 40px; font-size: 10px; color: #444; align-items: center; }
.sub-dot { width: 4px; height: 4px; border-radius: 50%; background: #a78bfa; }
.sidebar-footer { padding: 10px 12px; border-top: 1px solid #1e1e1e; margin-top: auto; font-size: 11px; color: #444; }
.sidebar-footer div { display: flex; justify-content: space-between; padding: 2px 0; }

/* Main */
.main { overflow-y: auto; padding: 16px 20px; display: flex; flex-direction: column; gap: 14px; }

/* Panel */
.panel { background: #141414; border: 1px solid #262626; border-radius: 8px; overflow: hidden; }
.panel-header { padding: 10px 16px; font-size: 11px; font-weight: 600; color: #666; text-transform: uppercase; letter-spacing: 0.06em; border-bottom: 1px solid #1e1e1e; display: flex; justify-content: space-between; align-items: center; }
.panel-body { padding: 16px; }

/* Stats row */
.stats-row { display: flex; gap: 14px; }
.stats-row .panel { flex: 1; }
.stat-card { text-align: center; padding: 4px; }
.stat-val { font-size: 26px; font-weight: 700; }
.stat-lbl { font-size: 10px; color: #555; margin-top: 2px; }
.blue { color: #3b82f6; } .green { color: #10b981; } .amber { color: #f59e0b; } .white { color: #e5e5e5; }

/* Treemap - nested */
.treemap { display: flex; height: 90px; border-radius: 4px; overflow: hidden; gap: 2px; }
.treemap-block { display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 500; color: rgba(255,255,255,0.9); flex-direction: column; gap: 1px; cursor: pointer; transition: opacity 0.15s; position: relative; }
.treemap-block:hover { opacity: 0.85; }
.treemap-block span { font-size: 8px; opacity: 0.7; }
.tm-system { background: #1e40af; }
.tm-tools { background: #be185d; }
/* Messages sub-blocks */
.tm-messages { display: flex; flex-direction: column; gap: 1px; }
.tm-messages-inner { display: flex; height: 100%; gap: 1px; }
.tm-tool-results { background: #065f46; display: flex; align-items: center; justify-content: center; flex-direction: column; }
.tm-sys-remind { background: #4338ca; display: flex; align-items: center; justify-content: center; flex-direction: column; }
.tm-thinking { background: #7c3aed; display: flex; align-items: center; justify-content: center; flex-direction: column; }
.tm-asst-text { background: #b45309; display: flex; align-items: center; justify-content: center; flex-direction: column; }
.tm-user-text { background: #059669; display: flex; align-items: center; justify-content: center; flex-direction: column; }

/* Agent breakdown */
.agent-row { display: flex; align-items: center; gap: 8px; padding: 4px 0; font-size: 12px; }
.agent-bar-wrap { flex: 1; height: 6px; background: #1a1a1a; border-radius: 3px; overflow: hidden; }
.agent-bar { height: 100%; border-radius: 3px; }
.agent-bar.opus { background: #fb923c; }
.agent-bar.haiku { background: #a78bfa; }
.agent-lbl { width: 100px; color: #888; font-size: 11px; }
.agent-val { width: 90px; text-align: right; color: #555; font-size: 11px; }

/* Timeline */
.timeline-chart { display: flex; align-items: flex-end; gap: 1px; height: 80px; }
.tl-bar { flex: 1; min-width: 6px; border-radius: 2px 2px 0 0; cursor: pointer; transition: opacity 0.15s; }
.tl-bar:hover { opacity: 0.8; }
.tl-bar.opus { background: linear-gradient(to top, #92400e, #fb923c); }
.tl-bar.haiku { background: linear-gradient(to top, #4c1d95, #a78bfa); }
.tl-bar.active { box-shadow: 0 0 0 1px #3b82f6; }
.tl-legend { display: flex; gap: 16px; margin-top: 8px; }
.tl-legend-item { display: flex; align-items: center; gap: 4px; font-size: 10px; color: #666; }
.tl-legend-dot { width: 8px; height: 8px; border-radius: 2px; }

/* Toggle */
.toggle-group { display: flex; }
.toggle { font-size: 10px; padding: 3px 10px; background: #1a1a1a; border: 1px solid #262626; color: #666; cursor: pointer; }
.toggle:first-child { border-radius: 4px 0 0 4px; }
.toggle:last-child { border-radius: 0 4px 4px 0; }
.toggle.active { background: #1e3a5f; border-color: #3b82f6; color: #93c5fd; }

/* Turn detail */
.turn-detail-header { display: flex; gap: 8px; align-items: center; margin-bottom: 12px; font-size: 12px; color: #888; }
.call-row { display: flex; align-items: center; gap: 8px; padding: 5px 8px; border-radius: 4px; font-size: 12px; margin-bottom: 2px; }
.call-row:hover { background: #1a1a1a; }
.call-row.main-call { background: #111827; border-radius: 4px; }
.call-model { font-size: 9px; padding: 1px 5px; border-radius: 2px; width: 46px; text-align: center; }
.call-desc { color: #888; flex: 1; }
.call-desc.main { color: #e5e5e5; }
.call-tok { color: #555; font-size: 11px; width: 70px; text-align: right; }
.call-cost { color: #10b981; font-size: 11px; width: 50px; text-align: right; }

/* Messages list - the real breakdown */
.msg-section { margin-top: 12px; border-top: 1px solid #1e1e1e; padding-top: 12px; }
.msg-section-title { font-size: 11px; color: #555; margin-bottom: 8px; display: flex; justify-content: space-between; }
.msg-category { margin-bottom: 8px; }
.msg-cat-header { display: flex; align-items: center; gap: 6px; padding: 4px 0; cursor: pointer; font-size: 12px; }
.msg-cat-header:hover { color: #fff; }
.msg-cat-dot { width: 8px; height: 8px; border-radius: 2px; flex-shrink: 0; }
.msg-cat-name { font-weight: 500; }
.msg-cat-stats { margin-left: auto; color: #444; font-size: 11px; }
.msg-cat-bar-wrap { width: 60px; height: 4px; background: #1a1a1a; border-radius: 2px; overflow: hidden; margin-left: 8px; }
.msg-cat-bar { height: 100%; border-radius: 2px; }

/* Individual items within category */
.msg-items { padding-left: 20px; border-left: 1px solid #1e1e1e; margin-left: 3px; }
.msg-line { display: flex; align-items: center; gap: 6px; padding: 3px 0; font-size: 11px; color: #888; border-bottom: 1px solid #0f0f0f; }
.msg-line:hover { color: #ccc; }
.msg-line-icon { color: #444; width: 14px; font-size: 10px; }
.msg-line-text { flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.msg-line-tok { color: #444; font-size: 10px; white-space: nowrap; }

/* Diff */
.diff-section { margin-top: 12px; border-top: 1px solid #1e1e1e; padding-top: 12px; }
.diff-header { font-size: 11px; color: #555; margin-bottom: 6px; display: flex; justify-content: space-between; }
.diff-line { font-family: 'SF Mono', 'Fira Code', Consolas, monospace; font-size: 11px; padding: 2px 8px; border-radius: 2px; margin-bottom: 1px; }
.diff-add { background: #071f0e; color: #4ade80; }
.diff-remove { background: #1f0707; color: #f87171; }
.diff-same { color: #333; }

/* Recommendations */
.rec-item { display: flex; align-items: flex-start; gap: 10px; padding: 8px 0; font-size: 12px; border-bottom: 1px solid #111; }
.rec-item:last-child { border-bottom: none; }
.rec-icon { font-size: 14px; margin-top: 1px; }
.rec-body { flex: 1; }
.rec-title { font-weight: 500; }
.rec-detail { font-size: 11px; color: #555; margin-top: 2px; }
.rec-impact { font-size: 10px; padding: 2px 6px; border-radius: 3px; white-space: nowrap; }
.rec-impact.high { background: #451a03; color: #fb923c; }
.rec-impact.med { background: #1c1917; color: #a8a29e; }
.rec-impact.low { background: #052e16; color: #34d399; }
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <span>üîç</span>
    <h1>Context Lens</h1>
    <div class="header-right">
      <span style="color: #10b981; font-weight: 600;">$0.47</span>
      <span style="color: #444;">72 requests</span>
      <select><option>All sources</option><option>claude</option><option>codex</option></select>
    </div>
  </div>

  <!-- Sidebar -->
  <div class="sidebar">
    <input class="sidebar-search" placeholder="Filter sessions..." />
    <div class="sidebar-section">Sessions</div>

    <div class="session-item active">
      <div class="session-head">
        <span class="dot dot-live"></span>
        <span class="badge badge-claude">claude</span>
        claude-opus-4-6
      </div>
      <div class="session-meta"><span>12 turns</span><span>142K tok</span><span style="color:#10b981;">$0.38</span></div>
    </div>
    <div class="turn-group">
      <div class="tg-item"><span class="tg-num">1</span><span class="tg-model tg-opus">opus</span><span style="color:#888">Hello</span><span class="tg-tokens">19.8K</span></div>
      <div class="sub-dots"><span class="sub-dot"></span> haiku √ó2</div>
      <div class="tg-item"><span class="tg-num">2</span><span class="tg-model tg-opus">opus</span><span style="color:#888">Check commits</span><span class="tg-tokens">20.3K</span></div>
      <div class="sub-dots"><span class="sub-dot"></span> haiku √ó1</div>
      <div class="tg-item"><span class="tg-num">3</span><span class="tg-model tg-opus">opus</span><span style="color:#888">Read .gitignore</span><span class="tg-tokens">24.2K</span></div>
      <div class="sub-dots"><span class="sub-dot"></span> haiku √ó3</div>
      <div class="tg-item active"><span class="tg-num">4</span><span class="tg-model tg-opus">opus</span><span style="color:#888">Grep for secrets</span><span class="tg-tokens">25.8K</span></div>
      <div class="sub-dots"><span class="sub-dot"></span> haiku √ó2</div>
      <div class="tg-item"><span class="tg-num">5</span><span class="tg-model tg-opus">opus</span><span style="color:#888">Remove from git</span><span class="tg-tokens">26.1K</span></div>
      <div class="tg-item"><span class="tg-num">6</span><span class="tg-model tg-opus">opus</span><span style="color:#888">Commit changes</span><span class="tg-tokens">33.9K</span></div>
      <div class="sub-dots"><span class="sub-dot"></span> haiku √ó1</div>
      <div style="padding: 4px 12px; font-size: 11px; color: #333; cursor: pointer;">+ 6 more turns...</div>
    </div>

    <div class="session-item">
      <div class="session-head">
        <span class="dot dot-done"></span>
        <span class="badge badge-codex">codex</span>
        gpt-5.3-codex
      </div>
      <div class="session-meta"><span>5 turns</span><span>37K tok</span><span style="color:#10b981;">$0.09</span></div>
    </div>

    <div class="sidebar-footer">
      <div><span>Main calls</span><span style="color:#fb923c;">18</span></div>
      <div><span>Subagent calls</span><span style="color:#a78bfa;">54</span></div>
      <div><span>Total cost</span><span style="color:#10b981;">$0.47</span></div>
    </div>
  </div>

  <!-- Main -->
  <div class="main">

    <!-- Stats -->
    <div class="stats-row">
      <div class="panel"><div class="panel-body"><div class="stat-card"><div class="stat-val blue">16%</div><div class="stat-lbl">Context used (33.9K / 200K)</div></div></div></div>
      <div class="panel"><div class="panel-body"><div class="stat-card"><div class="stat-val green">$0.38</div><div class="stat-lbl">Session cost</div></div></div></div>
      <div class="panel"><div class="panel-body"><div class="stat-card"><div class="stat-val white">23</div><div class="stat-lbl">Messages in context</div></div></div></div>
      <div class="panel"><div class="panel-body"><div class="stat-card"><div class="stat-val amber">6</div><div class="stat-lbl">Tool calls this turn</div></div></div></div>
    </div>

    <!-- Treemap - realistic breakdown -->
    <div class="panel">
      <div class="panel-header">
        Context Composition ‚Äî Turn 4 (33,889 tok)
        <div class="toggle-group">
          <div class="toggle active">Detailed</div>
          <div class="toggle">Simple</div>
        </div>
      </div>
      <div class="panel-body">
        <div class="treemap">
          <div class="treemap-block tm-system" style="flex: 4256;">
            System<span>4,256 (13%)</span>
          </div>
          <div class="treemap-block tm-tools" style="flex: 14556;">
            Tool defs<span>14,556 (43%)</span>
          </div>
          <!-- Messages broken into real sub-types -->
          <div class="treemap-block tm-tool-results" style="flex: 10510;">
            Tool results<span>10,510 (31%)</span>
          </div>
          <div class="treemap-block tm-sys-remind" style="flex: 918;">
            Sys inject<span>918 (3%)</span>
          </div>
          <div class="treemap-block tm-thinking" style="flex: 343;">
            Think<span>343 (1%)</span>
          </div>
          <div class="treemap-block tm-asst-text" style="flex: 372;">
            Asst<span>372 (1%)</span>
          </div>
          <div class="treemap-block tm-user-text" style="flex: 304;">
            User<span>304 (1%)</span>
          </div>
        </div>
        <div style="display: flex; gap: 12px; margin-top: 10px; flex-wrap: wrap;">
          <div style="display:flex;align-items:center;gap:4px;font-size:10px;color:#888;"><div style="width:10px;height:10px;border-radius:2px;background:#1e40af;"></div>System prompt</div>
          <div style="display:flex;align-items:center;gap:4px;font-size:10px;color:#888;"><div style="width:10px;height:10px;border-radius:2px;background:#be185d;"></div>Tool definitions</div>
          <div style="display:flex;align-items:center;gap:4px;font-size:10px;color:#888;"><div style="width:10px;height:10px;border-radius:2px;background:#065f46;"></div>Tool results</div>
          <div style="display:flex;align-items:center;gap:4px;font-size:10px;color:#888;"><div style="width:10px;height:10px;border-radius:2px;background:#4338ca;"></div>System injections</div>
          <div style="display:flex;align-items:center;gap:4px;font-size:10px;color:#888;"><div style="width:10px;height:10px;border-radius:2px;background:#7c3aed;"></div>Thinking</div>
          <div style="display:flex;align-items:center;gap:4px;font-size:10px;color:#888;"><div style="width:10px;height:10px;border-radius:2px;background:#b45309;"></div>Assistant</div>
          <div style="display:flex;align-items:center;gap:4px;font-size:10px;color:#888;"><div style="width:10px;height:10px;border-radius:2px;background:#059669;"></div>User</div>
        </div>
      </div>
    </div>

    <!-- Agent breakdown -->
    <div class="panel">
      <div class="panel-header">Agent Breakdown</div>
      <div class="panel-body">
        <div class="agent-row">
          <span class="agent-lbl">opus (main)</span>
          <div class="agent-bar-wrap"><div class="agent-bar opus" style="width:92%;"></div></div>
          <span class="agent-val">130K tok ¬∑ $0.35</span>
        </div>
        <div class="agent-row">
          <span class="agent-lbl">haiku (classify)</span>
          <div class="agent-bar-wrap"><div class="agent-bar haiku" style="width:5%;"></div></div>
          <span class="agent-val">4.2K tok ¬∑ $0.01</span>
        </div>
        <div class="agent-row">
          <span class="agent-lbl">haiku (topic)</span>
          <div class="agent-bar-wrap"><div class="agent-bar haiku" style="width:3%;"></div></div>
          <span class="agent-val">2.8K tok ¬∑ $0.01</span>
        </div>
        <div class="agent-row">
          <span class="agent-lbl">haiku (summary)</span>
          <div class="agent-bar-wrap"><div class="agent-bar haiku" style="width:4%;"></div></div>
          <span class="agent-val">5.1K tok ¬∑ $0.01</span>
        </div>
        <div style="margin-top:8px;font-size:11px;color:#444;">75% of calls are subagents, but only 8% of tokens. Tool results dominate context at 31%.</div>
      </div>
    </div>

    <!-- Timeline -->
    <div class="panel">
      <div class="panel-header">
        Timeline
        <div class="toggle-group">
          <div class="toggle active">All calls</div>
          <div class="toggle">Main only</div>
          <div class="toggle">Cost</div>
        </div>
      </div>
      <div class="panel-body">
        <div class="timeline-chart">
          <div class="tl-bar haiku" style="height:2%"></div>
          <div class="tl-bar opus" style="height:45%"></div>
          <div class="tl-bar haiku" style="height:4%"></div>
          <div class="tl-bar haiku" style="height:2%"></div>
          <div class="tl-bar opus" style="height:48%"></div>
          <div class="tl-bar haiku" style="height:2%"></div>
          <div class="tl-bar opus" style="height:55%"></div>
          <div class="tl-bar haiku" style="height:5%"></div>
          <div class="tl-bar haiku" style="height:3%"></div>
          <div class="tl-bar haiku" style="height:2%"></div>
          <div class="tl-bar opus active" style="height:62%"></div>
          <div class="tl-bar haiku" style="height:3%"></div>
          <div class="tl-bar haiku" style="height:2%"></div>
          <div class="tl-bar opus" style="height:63%"></div>
          <div class="tl-bar opus" style="height:82%"></div>
          <div class="tl-bar haiku" style="height:3%"></div>
          <div class="tl-bar opus" style="height:85%"></div>
          <div class="tl-bar haiku" style="height:4%"></div>
          <div class="tl-bar opus" style="height:88%"></div>
          <div class="tl-bar haiku" style="height:7%"></div>
          <div class="tl-bar opus" style="height:92%"></div>
          <div class="tl-bar haiku" style="height:3%"></div>
          <div class="tl-bar opus" style="height:95%"></div>
          <div class="tl-bar haiku" style="height:2%"></div>
          <div class="tl-bar opus" style="height:100%"></div>
        </div>
        <div class="tl-legend">
          <div class="tl-legend-item"><span class="tl-legend-dot" style="background:#fb923c;"></span>Main (opus)</div>
          <div class="tl-legend-item"><span class="tl-legend-dot" style="background:#a78bfa;"></span>Subagent (haiku)</div>
        </div>
      </div>
    </div>

    <!-- Turn Detail - realistic data -->
    <div class="panel">
      <div class="panel-header">
        Turn 4 ‚Äî Detail
        <div class="toggle-group">
          <div class="toggle active">Calls</div>
          <div class="toggle">Diff</div>
        </div>
      </div>
      <div class="panel-body">
        <!-- API calls in this turn group -->
        <div class="turn-detail-header">4 API calls in turn group</div>
        <div class="call-row">
          <span class="call-model tg-haiku">haiku</span>
          <span class="call-desc">Topic classifier ‚Äî "Is this a new topic?"</span>
          <span class="call-tok">128 tok</span>
          <span class="call-cost">$0.00</span>
        </div>
        <div class="call-row main-call">
          <span class="call-model tg-opus">opus</span>
          <span class="call-desc main">Grep for secrets ‚Äî Bash, Grep commands</span>
          <span class="call-tok">25,754 tok</span>
          <span class="call-cost">$0.05</span>
        </div>
        <div class="call-row">
          <span class="call-model tg-haiku">haiku</span>
          <span class="call-desc">Post-classifier ‚Äî update state</span>
          <span class="call-tok">421 tok</span>
          <span class="call-cost">$0.00</span>
        </div>
        <div class="call-row">
          <span class="call-model tg-haiku">haiku</span>
          <span class="call-desc">Summarizer ‚Äî compress for next turn</span>
          <span class="call-tok">644 tok</span>
          <span class="call-cost">$0.00</span>
        </div>

        <!-- Context breakdown - the REAL data -->
        <div class="msg-section">
          <div class="msg-section-title">
            <span>Main agent context ‚Äî 29 messages</span>
            <span>15,077 msg tokens</span>
          </div>

          <!-- Tool Results (dominant) -->
          <div class="msg-category">
            <div class="msg-cat-header">
              <span style="color:#666;">‚ñæ</span>
              <span class="msg-cat-dot" style="background:#065f46;"></span>
              <span class="msg-cat-name" style="color:#10b981;">Tool Results</span>
              <span class="msg-cat-stats">10,510 tok (70%)</span>
              <div class="msg-cat-bar-wrap"><div class="msg-cat-bar" style="width:70%;background:#065f46;"></div></div>
            </div>
            <div class="msg-items">
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">git ls-files ‚Üí .gitignore, CHANGELOG.md, CLI-IMPLEMENTATION.md...</span>
                <span class="msg-line-tok">66 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">git log --oneline --all ‚Üí d1d5839 Add early development notice...</span>
                <span class="msg-line-tok">51 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">git show --stat 373093b ‚Üí commit 373093bc... Author: Lars...</span>
                <span class="msg-line-tok">234 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">Read .gitignore ‚Üí # Node, node_modules/, npm-debug.log*...</span>
                <span class="msg-line-tok">198 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">Read test-request.json ‚Üí {"model": "claude-sonnet-4-20250514"...</span>
                <span class="msg-line-tok">299 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">Read test-demo.sh ‚Üí #!/bin/bash, # Demo script for Context...</span>
                <span class="msg-line-tok">588 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">git log --all --diff-filter=D ‚Üí (empty)</span>
                <span class="msg-line-tok">0 tok</span>
              </div>
              <div class="msg-line" style="color:#f59e0b;">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text" style="color:#f59e0b;">Grep for secrets ‚Üí .gitignore:12, test-demo.sh:5, test-demo.sh:8...</span>
                <span class="msg-line-tok" style="color:#f59e0b;">2,063 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">git diff --staged ‚Üí diff --git a/CHANGELOG.md b/CHANGELOG.md...</span>
                <span class="msg-line-tok" style="color:#f59e0b;">6,165 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">git status ‚Üí On branch main, up to date with origin/main...</span>
                <span class="msg-line-tok">155 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üìÑ</span>
                <span class="msg-line-text">git log --oneline -5 ‚Üí d1d5839 Add early development notice...</span>
                <span class="msg-line-tok">51 tok</span>
              </div>
            </div>
          </div>

          <!-- System Injections -->
          <div class="msg-category">
            <div class="msg-cat-header">
              <span style="color:#666;">‚ñæ</span>
              <span class="msg-cat-dot" style="background:#4338ca;"></span>
              <span class="msg-cat-name" style="color:#818cf8;">System Injections</span>
              <span class="msg-cat-stats">918 tok (6%)</span>
              <div class="msg-cat-bar-wrap"><div class="msg-cat-bar" style="width:6%;background:#4338ca;"></div></div>
            </div>
            <div class="msg-items">
              <div class="msg-line">
                <span class="msg-line-icon">‚öôÔ∏è</span>
                <span class="msg-line-text">&lt;system-reminder&gt; Available skills: read_file, write_file, search...</span>
                <span class="msg-line-tok">305 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">‚öôÔ∏è</span>
                <span class="msg-line-text">&lt;system-reminder&gt; Project context: CLAUDE.md, .cursorrules...</span>
                <span class="msg-line-tok">613 tok</span>
              </div>
            </div>
          </div>

          <!-- Tool Calls (outbound) -->
          <div class="msg-category">
            <div class="msg-cat-header">
              <span style="color:#666;">‚ñæ</span>
              <span class="msg-cat-dot" style="background:#be185d;"></span>
              <span class="msg-cat-name" style="color:#f472b6;">Tool Calls</span>
              <span class="msg-cat-stats">2,180 tok (14%)</span>
              <div class="msg-cat-bar-wrap"><div class="msg-cat-bar" style="width:14%;background:#be185d;"></div></div>
            </div>
            <div class="msg-items">
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Bash("git ls-files")</span>
                <span class="msg-line-tok">42 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Bash("git log --oneline --all")</span>
                <span class="msg-line-tok">48 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Bash("git show --stat 373093b")</span>
                <span class="msg-line-tok">52 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Read("/home/lars/.../context-lens/.gitignore")</span>
                <span class="msg-line-tok">38 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Read("/home/lars/.../context-lens/test-request.json")</span>
                <span class="msg-line-tok">44 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Read("/home/lars/.../context-lens/test-demo.sh")</span>
                <span class="msg-line-tok">42 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Bash("git log --all --diff-filter=D --name-only")</span>
                <span class="msg-line-tok">62 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Grep("(api[_-]?key|secret|password|token|credential)")</span>
                <span class="msg-line-tok">88 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Edit(".gitignore") ‚Äî add docs to ignore list</span>
                <span class="msg-line-tok">120 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Bash("git rm --cached CLI-IMPLEMENTATION.md MULTI-CLIENT.md...")</span>
                <span class="msg-line-tok">78 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Bash("git status")</span>
                <span class="msg-line-tok">32 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Bash("git diff --staged")</span>
                <span class="msg-line-tok">36 tok</span>
              </div>
              <div class="msg-line">
                <span class="msg-line-icon">üîß</span>
                <span class="msg-line-text">Bash("git log --oneline -5")</span>
                <span class="msg-line-tok">38 tok</span>
              </div>
            </div>
          </div>

          <!-- Thinking -->
          <div class="msg-category">
            <div class="msg-cat-header">
              <span style="color:#666;">‚ñ∏</span>
              <span class="msg-cat-dot" style="background:#7c3aed;"></span>
              <span class="msg-cat-name" style="color:#a78bfa;">Thinking</span>
              <span class="msg-cat-stats">343 tok (2%)</span>
              <div class="msg-cat-bar-wrap"><div class="msg-cat-bar" style="width:2%;background:#7c3aed;"></div></div>
            </div>
          </div>

          <!-- Assistant text -->
          <div class="msg-category">
            <div class="msg-cat-header">
              <span style="color:#666;">‚ñ∏</span>
              <span class="msg-cat-dot" style="background:#b45309;"></span>
              <span class="msg-cat-name" style="color:#f59e0b;">Assistant Responses</span>
              <span class="msg-cat-stats">372 tok (2%)</span>
              <div class="msg-cat-bar-wrap"><div class="msg-cat-bar" style="width:2%;background:#b45309;"></div></div>
            </div>
          </div>

          <!-- User text -->
          <div class="msg-category">
            <div class="msg-cat-header">
              <span style="color:#666;">‚ñ∏</span>
              <span class="msg-cat-dot" style="background:#059669;"></span>
              <span class="msg-cat-name" style="color:#10b981;">User Messages</span>
              <span class="msg-cat-stats">304 tok (2%)</span>
              <div class="msg-cat-bar-wrap"><div class="msg-cat-bar" style="width:2%;background:#059669;"></div></div>
            </div>
          </div>
        </div>

        <!-- Diff -->
        <div class="diff-section">
          <div class="diff-header">
            <span>Turn 3 ‚Üí Turn 4</span>
            <span>+7,805 tokens</span>
          </div>
          <div class="diff-line diff-same">  system: 4,256 tok (unchanged)</div>
          <div class="diff-line diff-same">  tools: 14,556 tok (unchanged)</div>
          <div class="diff-line diff-same">  sys-inject: 918 tok (unchanged)</div>
          <div class="diff-line diff-add">+ user: "Yes. And let's keep the design docs, but remove them from git" (15 tok)</div>
          <div class="diff-line diff-add">+ tool_use: Read(.gitignore) (38 tok)</div>
          <div class="diff-line diff-add">+ tool_result: .gitignore contents (198 tok)</div>
          <div class="diff-line diff-add">+ tool_use: Edit(.gitignore) (120 tok)</div>
          <div class="diff-line diff-add">+ tool_result: "file has been edited" (20 tok)</div>
          <div class="diff-line diff-add">+ tool_use: Bash(git rm --cached ...) (78 tok)</div>
          <div class="diff-line diff-add">+ tool_result: "rm CHANGELOG.md, rm CLI-IMPL..." (25 tok)</div>
          <div class="diff-line diff-add">+ assistant: "Done. The five design docs are removed..." (44 tok)</div>
          <div class="diff-line diff-add">+ user: "Great" (1 tok)</div>
          <div class="diff-line diff-add">+ assistant: "Shall I commit these changes?" (7 tok)</div>
          <div class="diff-line diff-add">+ user: "Yes" (0 tok)</div>
          <div class="diff-line diff-add">+ tool_use: Bash(git status) + Bash(git diff --staged) + Bash(git log) (106 tok)</div>
          <div class="diff-line diff-add" style="color:#f59e0b;">+ tool_result: git diff --staged output (6,165 tok) ‚Üê LARGEST</div>
          <div class="diff-line diff-add">+ tool_result: git status (155 tok)</div>
          <div class="diff-line diff-add">+ tool_result: git log (51 tok)</div>
        </div>
      </div>
    </div>

    <!-- Recommendations -->
    <div class="panel">
      <div class="panel-header">Recommendations <span style="font-size:10px;color:#555;">5 findings</span></div>
      <div class="panel-body">
        <div class="rec-item">
          <span class="rec-icon">üî¥</span>
          <div class="rec-body">
            <div class="rec-title">git diff --staged is 6,165 tokens (18% of total context)</div>
            <div class="rec-detail">Single tool result consuming disproportionate context. Consider truncating large diffs or using --stat instead.</div>
          </div>
          <span class="rec-impact high">6,165 tok</span>
        </div>
        <div class="rec-item">
          <span class="rec-icon">‚ö†Ô∏è</span>
          <div class="rec-body">
            <div class="rec-title">Tool definitions are 43% of context but only 4 unique tools used</div>
            <div class="rec-detail">14,556 tokens for tool definitions. Only Bash, Read, Edit, Grep called this session. 12+ tools loaded but unused.</div>
          </div>
          <span class="rec-impact high">~10K tok</span>
        </div>
        <div class="rec-item">
          <span class="rec-icon">‚ö†Ô∏è</span>
          <div class="rec-body">
            <div class="rec-title">Tool results are 70% of the messages section</div>
            <div class="rec-detail">Your conversation is 2% user text, 70% file contents and command output. Consider summarizing older tool results.</div>
          </div>
          <span class="rec-impact med">Structural</span>
        </div>
        <div class="rec-item">
          <span class="rec-icon">üí°</span>
          <div class="rec-body">
            <div class="rec-title">Duplicate file reads detected</div>
            <div class="rec-detail">.gitignore was read twice (turn 2 and turn 4). 198 tokens could be saved by caching.</div>
          </div>
          <span class="rec-impact med">198 tok</span>
        </div>
        <div class="rec-item">
          <span class="rec-icon">‚úÖ</span>
          <div class="rec-body">
            <div class="rec-title">Context utilization healthy at 16%</div>
            <div class="rec-detail">33,889 of 200K tokens used. Well within safe range.</div>
          </div>
          <span class="rec-impact low">OK</span>
        </div>
      </div>
    </div>

  </div>
</div>
</body>
</html>
